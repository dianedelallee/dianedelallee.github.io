<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Launch a Django app in a Docker and be ready to put in Production | Fatalement</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Launch a Django app in a Docker and be ready to put in Production" /><meta name="author" content="Diane Delallée" /><meta property="og:locale" content="en_US" /><meta name="description" content="New year, new resolution, so today I have decided to play a bit with Docker, Django, Gunicorn and Nginx. So first we will create a Django in a Docker with a Postgres DB, and after we will add production environment and Nginx and Gunicorn. lets create the project" /><meta property="og:description" content="New year, new resolution, so today I have decided to play a bit with Docker, Django, Gunicorn and Nginx. So first we will create a Django in a Docker with a Postgres DB, and after we will add production environment and Nginx and Gunicorn. lets create the project" /><link rel="canonical" href="https://dianedelallee.github.io/posts/django-in-a-docker/" /><meta property="og:url" content="https://dianedelallee.github.io/posts/django-in-a-docker/" /><meta property="og:site_name" content="Fatalement" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-15T13:55:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Launch a Django app in a Docker and be ready to put in Production" /><meta name="twitter:site" content="@dianedelallee" /><meta name="twitter:creator" content="@Diane Delallée" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://dianedelallee.github.io/posts/django-in-a-docker/"},"description":"New year, new resolution, so today I have decided to play a bit with Docker, Django, Gunicorn and Nginx. So first we will create a Django in a Docker with a Postgres DB, and after we will add production environment and Nginx and Gunicorn. lets create the project","@type":"BlogPosting","url":"https://dianedelallee.github.io/posts/django-in-a-docker/","headline":"Launch a Django app in a Docker and be ready to put in Production","dateModified":"2020-01-15T13:55:00+01:00","datePublished":"2020-01-15T13:55:00+01:00","author":{"@type":"Person","name":"Diane Delallée"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="" class="d-flex justify-content-left"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.png" alt="avatar" width="200"> </a></div><div class="profile-text mt-3"><div id="site-subtitle" class="font-italic"> <a href="/">Diane Delallée</a></div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-left mt-4"> <a href="https://linkedin.com/in/dianedelallee" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/dianedelallee" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://gitlab.com/dianedelallee" target="_blank"> <i class="fab fa-gitlab"></i> </a> <a href="https://stackoverflow.com/users/4640061/diane-delallée" target="_blank"> <i class="fab fa-stack-overflow"></i> </a> <a href="https://codepen.io/dianedelallee/" target="_blank"> <i class="fab fa-codepen"></i> </a></div><div class="sidebar-bottom d-flex flex-wrap justify-content-left mt-4"> <a href="https://www.discogs.com/user/dianedelallee/collection" target="_blank"> <i class="fas fa-compact-disc"></i> </a> <a href="https://www.instagram.com/fixie_des_alpes/" target="_blank"> <i class="fab fa-instagram"></i> </a> <a href="https://twitter.com/dianedelallee" target="_blank"> <i class="fab fa-twitter"></i> </a> <span class="icon-border"></span> <a href="mailto:diane.delallee@gmail.com"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Launch a Django app in a Docker and be ready to put in Production</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Launch a Django app in a Docker and be ready to put in Production</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Wed, Jan 15, 2020, 1:55 PM +0100"> Jan 15, 2020 <i class="unloaded">2020-01-15T13:55:00+01:00</i> </span> by <span class="author"> Diane Delallée </span></div></div><div class="post-content"><p>New year, new resolution, so today I have decided to play a bit with Docker, Django, Gunicorn and Nginx. So first we will create a Django in a Docker with a Postgres DB, and after we will add production environment and Nginx and Gunicorn. lets create the project</p><h2 id="lets-create-a-django-project">Lets create a Django project</h2><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>django-in-a-docker <span class="o">&amp;&amp;</span> <span class="nb">cd </span>django-in-a-docker
<span class="nb">mkdir </span>app <span class="o">&amp;&amp;</span> <span class="nb">cd </span>app
python3.7 <span class="nt">-m</span> venv <span class="nb">env
source env</span>/bin/activate
<span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>pip <span class="nb">install </span><span class="nv">django</span><span class="o">==</span>2.2.9
<span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>django-admin.py startproject hello_django <span class="nb">.</span>
<span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>python manage.py migrate
<span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>python manage.py runserver
</pre></table></code></div></div><p>if you navigate to <a href="http://localhost:8000/">http://localhost:8000/</a> you should see the Django welcome screen. In order to put all our libraries in the same file, we will create a requirements.txt file which contains <code class="highlighter-rouge">Django==2.2.9</code> As we will use Postgres, we can remove the db.sqlite file from the “app” directory. Now your Django project works, let continue a create the Docker files.</p><h2 id="start-to-play-with-docker">Start to play with Docker</h2><p>Now your project directory should look like that:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>django-in-a-docker
|<span class="se">\_</span> app
├── hello_django
│ ├── <span class="k">**</span>init<span class="k">**</span>.py
│ ├── settings.py
│ ├── urls.py
│ └── wsgi.py
├── manage.py
└── requirements.txt
</pre></table></code></div></div><p>If you do not have Docker install please <a href="https://docs.docker.com/get-docker/">install Docker</a>. Then you create a Dockerfile to the app directory. And write the following configuration in it</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1"># pull official base image
</span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.7</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">alpine</span>

<span class="c1"># set work directory
</span><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span>

<span class="c1"># set environment variables
</span><span class="n">ENV</span> <span class="n">PYTHONDONTWRITEBYTECODE</span> <span class="mi">1</span>
<span class="n">ENV</span> <span class="n">PYTHONUNBUFFERED</span> <span class="mi">1</span>

<span class="c1"># install dependencies
</span><span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
<span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="c1"># copy project
</span><span class="n">COPY</span> <span class="p">.</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</pre></table></code></div></div><p>We are using an Alpine version of Docker for Python 3.7, and we set the working directory. We also update pip and install all the requirements.</p><p>Now we will need to define the docker-compose.yml file. Place it in the “django-in-a-docker” directory (same level as the app directeory) and write that</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">version</span><span class="p">:</span> <span class="s">'3.7'</span>

<span class="n">services</span><span class="p">:</span>
<span class="n">web</span><span class="p">:</span>
<span class="n">build</span><span class="p">:</span> <span class="p">.</span><span class="o">/</span><span class="n">app</span>
<span class="n">command</span><span class="p">:</span> <span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">runserver</span> <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8000</span>
<span class="n">volumes</span><span class="p">:</span> <span class="o">-</span> <span class="p">.</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
<span class="n">ports</span><span class="p">:</span> <span class="o">-</span> <span class="mi">8000</span><span class="p">:</span><span class="mi">8000</span>
<span class="n">env_file</span><span class="p">:</span> <span class="o">-</span> <span class="p">.</span><span class="o">/</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">dev</span>
</pre></table></code></div></div><p>Now we will update the SECRET_KEY, DEBUG and ALLOWED_HOSTS in settings.py to place them in a .env.dev file. This file should be in the “django-in-a-docker” directory. In your settings.py changeyour code by that:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SECRET_KEY"</span><span class="p">)</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"DEBUG"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"DJANGO_ALLOWED_HOSTS"</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">", "</span><span class="p">)</span>
</pre></table></code></div></div><p>and in the .env.dev</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>DEBUG=1
SECRET_KEY=my_anazing_secret_key
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1
</pre></table></code></div></div><h2 id="lets-configure-our-postgres-db">Lets configure our Postgres DB</h2><p>To configure Postgres, we’ll need to add a new service to the docker-compose.yml file, update the Django settings, and install Psycopg2. Lets update the docker-compose.yml</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="n">version</span><span class="p">:</span> <span class="s">'3.7'</span>

<span class="n">services</span><span class="p">:</span>
<span class="n">web</span><span class="p">:</span>
<span class="n">build</span><span class="p">:</span> <span class="p">.</span><span class="o">/</span><span class="n">app</span>
<span class="n">command</span><span class="p">:</span> <span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">runserver</span> <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8000</span>
<span class="n">volumes</span><span class="p">:</span> <span class="o">-</span> <span class="p">.</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
<span class="n">ports</span><span class="p">:</span> <span class="o">-</span> <span class="mi">8000</span><span class="p">:</span><span class="mi">8000</span>
<span class="n">env_file</span><span class="p">:</span> <span class="o">-</span> <span class="p">.</span><span class="o">/</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">dev</span>
<span class="n">depends_on</span><span class="p">:</span> <span class="o">-</span> <span class="n">db</span>
<span class="n">db</span><span class="p">:</span>
<span class="n">image</span><span class="p">:</span> <span class="n">postgres</span><span class="p">:</span><span class="mf">12.0</span><span class="o">-</span><span class="n">alpine</span>
<span class="n">volumes</span><span class="p">:</span> <span class="o">-</span> <span class="n">postgres_data</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="n">data</span><span class="o">/</span>
<span class="n">environment</span><span class="p">:</span> <span class="o">-</span> <span class="n">POSTGRES_USER</span><span class="o">=</span><span class="n">hello_django</span> <span class="o">-</span> <span class="n">POSTGRES_PASSWORD</span><span class="o">=</span><span class="n">hello_django</span> <span class="o">-</span> <span class="n">POSTGRES_DB</span><span class="o">=</span><span class="n">hello_django_dev</span>

<span class="n">volumes</span><span class="p">:</span>
<span class="n">postgres_data</span><span class="p">:</span>
</pre></table></code></div></div><p>We can also update the .env.dev file</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">DEBUG</span><span class="o">=</span><span class="mi">1</span>
<span class="n">SECRET_KEY</span><span class="o">=</span><span class="n">foo</span>
<span class="n">DJANGO_ALLOWED_HOSTS</span><span class="o">=</span><span class="n">localhost</span> <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="p">[::</span><span class="mi">1</span><span class="p">]</span>
<span class="n">SQL_ENGINE</span><span class="o">=</span><span class="n">django</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">postgresql</span>
<span class="n">SQL_DATABASE</span><span class="o">=</span><span class="n">hello_django_dev</span>
<span class="n">SQL_USER</span><span class="o">=</span><span class="n">hello_django</span>
<span class="n">SQL_PASSWORD</span><span class="o">=</span><span class="n">hello_django</span>
<span class="n">SQL_HOST</span><span class="o">=</span><span class="n">db</span>
<span class="n">SQL_PORT</span><span class="o">=</span><span class="mi">5432</span>
</pre></table></code></div></div><p>In the settings.py we now need to update the DATABASES section. Replace it by</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"default"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">"ENGINE"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SQL_ENGINE"</span><span class="p">,</span> <span class="s">"django.db.backends.sqlite3"</span><span class="p">),</span>
    <span class="s">"NAME"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SQL_DATABASE"</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">"db.sqlite3"</span><span class="p">)),</span>
    <span class="s">"USER"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SQL_USER"</span><span class="p">,</span> <span class="s">"user"</span><span class="p">),</span>
    <span class="s">"PASSWORD"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SQL_PASSWORD"</span><span class="p">,</span> <span class="s">"password"</span><span class="p">),</span>
    <span class="s">"HOST"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SQL_HOST"</span><span class="p">,</span> <span class="s">"localhost"</span><span class="p">),</span>
    <span class="s">"PORT"</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"SQL_PORT"</span><span class="p">,</span> <span class="s">"5432"</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Lets update the Dockerfile to install Psycopg2</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1"># pull official base image
</span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.7</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">alpine</span>

<span class="c1"># set work directory
</span><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span>

<span class="c1"># set environment variables
</span><span class="n">ENV</span> <span class="n">PYTHONDONTWRITEBYTECODE</span> <span class="mi">1</span>
<span class="n">ENV</span> <span class="n">PYTHONUNBUFFERED</span> <span class="mi">1</span>

<span class="c1"># install psycopg2 dependencies
</span><span class="n">RUN</span> <span class="n">apk</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apk</span> <span class="n">add</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">dev</span> <span class="n">gcc</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">musl</span><span class="o">-</span><span class="n">dev</span>

<span class="c1"># install dependencies
</span><span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
<span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="c1"># copy project
</span><span class="n">COPY</span> <span class="p">.</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</pre></table></code></div></div><p>And last step, we will need to add Psycopg2 to our requirements.txt</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Django==2.2.9
psycopg2-binary==2.8.3
</pre></table></code></div></div><p>We have to build our docker and run the migrations</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>docker-compose build
docker-compose up <span class="nt">-d</span>
docker-compose <span class="nb">exec </span>web python manage.py migrate <span class="nt">--noinput</span>
</pre></table></code></div></div><p>To be sure that the django table are properly created, just run</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre>docker-compose <span class="nb">exec </span>db psql <span class="nt">--username</span><span class="o">=</span>hello_django <span class="nt">--dbname</span><span class="o">=</span>hello_django_dev

psql <span class="o">(</span>12.0<span class="o">)</span>
Type <span class="s2">"help"</span> <span class="k">for </span>help.

<span class="nv">hello_django_dev</span><span class="o">=</span><span class="c"># \l</span>
List of databases
Name | Owner | Encoding | Collate | Ctype | Access privileges
<span class="nt">------------------</span>+--------------+----------+------------+------------+-------------------------------
hello_django_dev | hello_django | UTF8 | en_US.utf8 | en_US.utf8 |
postgres | hello_django | UTF8 | en_US.utf8 | en_US.utf8 |
template0 | hello_django | UTF8 | en_US.utf8 | en_US.utf8 | <span class="o">=</span>c/hello_django +
| | | | | <span class="nv">hello_django</span><span class="o">=</span>CTc/hello_django
template1 | hello_django | UTF8 | en_US.utf8 | en_US.utf8 | <span class="o">=</span>c/hello_django +
| | | | | <span class="nv">hello_django</span><span class="o">=</span>CTc/hello_django
<span class="o">(</span>4 rows<span class="o">)</span>

<span class="nv">hello_django_dev</span><span class="o">=</span><span class="c"># \c hello_django_dev</span>
You are now connected to database <span class="s2">"hello_django_dev"</span> as user <span class="s2">"hello_django"</span><span class="nb">.</span>

<span class="nv">hello_django_dev</span><span class="o">=</span><span class="c"># \dt</span>
List of relations
Schema | Name | Type | Owner
<span class="nt">--------</span>+----------------------------+-------+--------------
public | auth_group | table | hello_django
public | auth_group_permissions | table | hello_django
public | auth_permission | table | hello_django
public | auth_user | table | hello_django
public | auth_user_groups | table | hello_django
public | auth_user_user_permissions | table | hello_django
public | django_admin_log | table | hello_django
public | django_content_type | table | hello_django
public | django_migrations | table | hello_django
public | django_session | table | hello_django
<span class="o">(</span>10 rows<span class="o">)</span>

<span class="nv">hello_django_dev</span><span class="o">=</span><span class="c"># \q</span>
</pre></table></code></div></div><h2 id="define-entrypointsh">Define entrypoint.sh</h2><p>To check if the Postgres DB is healthy we will add a entrypoint.sh. It will helps us to not run migrations on unhealthy DB. Create this file in te “app” folder and copy/paste those lines.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$DATABASE</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"postgres"</span> <span class="o">]</span>
<span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Waiting for postgres..."</span>

    <span class="k">while</span> <span class="o">!</span> nc <span class="nt">-z</span> <span class="nv">$SQL_HOST</span> <span class="nv">$SQL_PORT</span><span class="p">;</span> <span class="k">do
      </span><span class="nb">sleep </span>0.1
    <span class="k">done

    </span><span class="nb">echo</span> <span class="s2">"PostgreSQL started"</span>

<span class="k">fi

</span>python manage.py flush <span class="nt">--no-input</span>
python manage.py migrate

<span class="nb">exec</span> <span class="s2">"</span><span class="se">\$</span><span class="s2">@"</span>
</pre></table></code></div></div><p>you now need to change the permissions on the file by <code class="highlighter-rouge">chmod +x app/entrypoint.sh</code>. Now we can update the Dockerfile to copy over the entrypoint.sh</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1"># pull official base image
</span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.7</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">alpine</span>

<span class="c1"># set work directory
</span><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span>

<span class="c1"># set environment variables
</span><span class="n">ENV</span> <span class="n">PYTHONDONTWRITEBYTECODE</span> <span class="mi">1</span>
<span class="n">ENV</span> <span class="n">PYTHONUNBUFFERED</span> <span class="mi">1</span>

<span class="c1"># install psycopg2 dependencies
</span><span class="n">RUN</span> <span class="n">apk</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apk</span> <span class="n">add</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">dev</span> <span class="n">gcc</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">musl</span><span class="o">-</span><span class="n">dev</span>

<span class="c1"># install dependencies
</span><span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
<span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="c1"># copy entrypoint.sh
</span><span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">entrypoint</span><span class="p">.</span><span class="n">sh</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">entrypoint</span><span class="p">.</span><span class="n">sh</span>

<span class="c1"># copy project
</span><span class="n">COPY</span> <span class="p">.</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>

<span class="c1"># run entrypoint.sh
</span><span class="n">ENTRYPOINT</span> <span class="p">[</span><span class="s">"/usr/src/app/entrypoint.sh"</span><span class="p">]</span>
</pre></table></code></div></div><p>We will add the DB to the env.dev file</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>DEBUG=1
SECRET_KEY=foo
DJANGO_ALLOWED_HOSTS=localhost 127.0.0.1 [::1]
SQL_ENGINE=django.db.backends.postgresql
SQL_DATABASE=hello_django_dev
SQL_USER=hello_django
SQL_PASSWORD=hello_django
SQL_HOST=db
SQL_PORT=5432
DATABASE=postgres
</pre></table></code></div></div><p>Okay so lets rebuild our docker image and run the container</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker-compose up <span class="nt">-d</span> <span class="nt">--build</span>
</pre></table></code></div></div><p>If you navigate to <a href="http://localhost:8000/">http://localhost:8000/</a> you should see again the Django Welcome page :-). Well done, your Django in a Docker works perfectly for development environment</p><h2 id="lets-configure-it-to-be-ready-for-production">Lets configure it to be ready for Production</h2><h3 id="gunicorn">Gunicorn</h3><p>In our requirements.txt, lets add the Gunicorn reference</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Django==2.2.9
gunicorn==19.9.0
psycopg2-binary==2.8.3
</pre></table></code></div></div><p>Since we still want to use Django’s built-in server in development, create a new compose file called docker-compose.prod.yml for production</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>version: '3.7'

services:
web:
build:
context: ./app
dockerfile: Dockerfile.prod
command: gunicorn hello_django.wsgi:application --bind 0.0.0.0:8000
ports: - 8000:8000
env_file: - ./.env.prod
depends_on: - db
db:
image: postgres:12.0-alpine
volumes: - postgres_data:/var/lib/postgresql/data/
env_file: - ./.env.prod.db

volumes:
postgres_data:
</pre></table></code></div></div><p>As you can see in the docker-compose.prod.yml we have define a .env.prod and a .env.prod.db files to store all the varaible relative to the production. Lets create this file in the “django-in-a-docker” directory and write that</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre># .env.prod

DEBUG=0
SECRET_KEY=change_me
DJANGO_ALLOWED_HOSTS=localhost 127.0.0.1 [::1]
SQL_ENGINE=django.db.backends.postgresql
SQL_DATABASE=hello_django_prod
SQL_USER=hello_django
SQL_PASSWORD=hello_django
SQL_HOST=db
SQL_PORT=5432
DATABASE=postgres
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># .env.prod.db

POSTGRES_USER=hello_django
POSTGRES_PASSWORD=hello_django
POSTGRES_DB=hello_django_prod
</pre></table></code></div></div><p>Lets create the Production Docker file now. First we need to create our entrypoint.prod.sh and as previously update the permissions on it <code class="highlighter-rouge">chmod +x app/entrypoint.prod.sh</code></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$DATABASE</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"postgres"</span> <span class="o">]</span>
<span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Waiting for postgres..."</span>

    <span class="k">while</span> <span class="o">!</span> nc <span class="nt">-z</span> <span class="nv">$SQL_HOST</span> <span class="nv">$SQL_PORT</span><span class="p">;</span> <span class="k">do
      </span><span class="nb">sleep </span>0.1
    <span class="k">done

    </span><span class="nb">echo</span> <span class="s2">"PostgreSQL started"</span>

<span class="k">fi

</span><span class="nb">exec</span> <span class="s2">"</span><span class="se">\$</span><span class="s2">@"</span>
</pre></table></code></div></div><p>To use this file, create a new Dockerfile called Dockerfile.prod for use with production builds</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre><span class="c1">###########
# BUILDER
###########
</span>
<span class="c1"># pull official base image
</span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.7</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">alpine</span> <span class="k">as</span> <span class="n">builder</span>

<span class="c1"># set work directory
</span><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span>

<span class="c1"># set environment variables
</span><span class="n">ENV</span> <span class="n">PYTHONDONTWRITEBYTECODE</span> <span class="mi">1</span>
<span class="n">ENV</span> <span class="n">PYTHONUNBUFFERED</span> <span class="mi">1</span>

<span class="c1"># install psycopg2 dependencies
</span><span class="n">RUN</span> <span class="n">apk</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apk</span> <span class="n">add</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">dev</span> <span class="n">gcc</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">musl</span><span class="o">-</span><span class="n">dev</span>

<span class="c1"># lint
</span><span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">flake8</span>
<span class="n">COPY</span> <span class="p">.</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
<span class="n">RUN</span> <span class="n">flake8</span> <span class="o">--</span><span class="n">ignore</span><span class="o">=</span><span class="n">E501</span><span class="p">,</span><span class="n">F401</span> <span class="p">.</span>

<span class="c1"># install dependencies
</span><span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span> <span class="p">.</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">wheel</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="nb">dir</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">deps</span> <span class="o">--</span><span class="n">wheel</span><span class="o">-</span><span class="nb">dir</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">wheels</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="c1">#########
# FINAL
#########
</span>
<span class="c1"># pull official base image
</span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.7</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">alpine</span>

<span class="c1"># create directory for the app user
</span><span class="n">RUN</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">app</span>

<span class="c1"># create the app user
</span><span class="n">RUN</span> <span class="n">addgroup</span> <span class="o">-</span><span class="n">S</span> <span class="n">app</span> <span class="o">&amp;&amp;</span> <span class="n">adduser</span> <span class="o">-</span><span class="n">S</span> <span class="n">app</span> <span class="o">-</span><span class="n">G</span> <span class="n">app</span>

<span class="c1"># create the appropriate directories
</span><span class="n">ENV</span> <span class="n">HOME</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">app</span>
<span class="n">ENV</span> <span class="n">APP_HOME</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">web</span>
<span class="n">RUN</span> <span class="n">mkdir</span> <span class="err">$</span><span class="n">APP_HOME</span>
<span class="n">WORKDIR</span> <span class="err">$</span><span class="n">APP_HOME</span>

<span class="c1"># install dependencies
</span><span class="n">RUN</span> <span class="n">apk</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apk</span> <span class="n">add</span> <span class="n">libpq</span>
<span class="n">COPY</span> <span class="o">--</span><span class="k">from</span><span class="o">=</span><span class="n">builder</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">wheels</span> <span class="o">/</span><span class="n">wheels</span>
<span class="n">COPY</span> <span class="o">--</span><span class="k">from</span><span class="o">=</span><span class="n">builder</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span> <span class="p">.</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cache</span> <span class="o">/</span><span class="n">wheels</span><span class="o">/</span>\<span class="o">*</span>

<span class="c1"># copy entrypoint-prod.sh
</span><span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">entrypoint</span><span class="p">.</span><span class="n">prod</span><span class="p">.</span><span class="n">sh</span> \<span class="err">$</span><span class="n">APP_HOME</span>

<span class="c1"># copy project
</span><span class="n">COPY</span> <span class="p">.</span> \<span class="err">$</span><span class="n">APP_HOME</span>

<span class="c1"># chown all the files to the app user
</span><span class="n">RUN</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">app</span><span class="p">:</span><span class="n">app</span> \<span class="err">$</span><span class="n">APP_HOME</span>

<span class="c1"># change to the app user
</span><span class="n">USER</span> <span class="n">app</span>

<span class="c1"># run entrypoint.prod.sh
</span><span class="n">ENTRYPOINT</span> <span class="p">[</span><span class="s">"/home/app/web/entrypoint.prod.sh"</span><span class="p">]</span>
</pre></table></code></div></div><h3 id="nginx">Nginx</h3><p>We need to add this service to our docker-compose.proc.yml</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>version: '3.7'

services:
web:
build:
context: ./app
dockerfile: Dockerfile.prod
command: gunicorn hello_django.wsgi:application --bind 0.0.0.0:8000
ports: - 8000:8000
env_file: - ./.env.prod
depends_on: - db
db:
image: postgres:12.0-alpine
volumes: - postgres_data:/var/lib/postgresql/data/
env_file: - ./.env.prod.db
nginx:
build: ./nginx
ports: - 1337:80
depends_on: - web

volumes:
postgres_data:
</pre></table></code></div></div><p>Lets create in the django-in-a-docker directory a new folder called “nginx” which will contains two files. one Dockerfile and one nginx.conf</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># Dockerfile
</span>
<span class="n">FROM</span> <span class="n">nginx</span><span class="p">:</span><span class="mf">1.17</span><span class="p">.</span><span class="mi">4</span><span class="o">-</span><span class="n">alpine</span>

<span class="n">RUN</span> <span class="n">rm</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">default</span><span class="p">.</span><span class="n">conf</span>
<span class="n">COPY</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># nginx.conf:
</span><span class="n">upstream</span> <span class="n">hello_django</span> <span class="p">{</span>
<span class="n">server</span> <span class="n">web</span><span class="p">:</span><span class="mi">8000</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">server</span> <span class="p">{</span>
    <span class="n">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
        <span class="n">proxy_pass</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">hello_django</span><span class="p">;</span>
        <span class="n">proxy_set_header</span> <span class="n">X</span><span class="o">-</span><span class="n">Forwarded</span><span class="o">-</span><span class="n">For</span> <span class="err">$</span><span class="n">proxy_add_x_forwarded_for</span><span class="p">;</span>
        <span class="n">proxy_set_header</span> <span class="n">Host</span> <span class="err">$</span><span class="n">host</span><span class="p">;</span>
        <span class="n">proxy_redirect</span> <span class="n">off</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>now we need to update our docker-compose.prod.yml to take this change into account</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>version: '3.7'

services:
web:
build:
context: ./app
dockerfile: Dockerfile.prod
command: gunicorn hello_django.wsgi:application --bind 0.0.0.0:8000
expose: - 8000
env_file: - ./.env.prod
depends_on: - db
db:
image: postgres:12.0-alpine
volumes: - postgres_data:/var/lib/postgresql/data/
env_file: - ./.env.prod.db
nginx:
build: ./nginx
ports: - 1337:80
depends_on: - web

volumes:
postgres_data:
</pre></table></code></div></div><p>Now our app should be like that</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>├── .env.dev
├── .env.prod
├── .env.prod.db
├── .gitignore
├── app
│ ├── Dockerfile
│ ├── Dockerfile.prod
│ ├── entrypoint.prod.sh
│ ├── entrypoint.sh
│ ├── hello_django
│ │ ├── <span class="k">**</span>init<span class="k">**</span>.py
│ │ ├── settings.py
│ │ ├── urls.py
│ │ └── wsgi.py
│ ├── manage.py
│ └── requirements.txt
├── docker-compose.prod.yml
├── docker-compose.yml
└── nginx
├── Dockerfile
└── nginx.conf
</pre></table></code></div></div><h2 id="static-files">Static files</h2><h3 id="how-to-configure-the-development-environment">How to configure the development environment</h3><p>Lets update the settings.py</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">STATIC_URL</span> <span class="o">=</span> <span class="s">"/staticfiles/"</span>
<span class="n">STATIC_ROOT</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">"staticfiles"</span><span class="p">)</span>
</pre></table></code></div></div><p>We can now update the entrypoint.sh in order to collect all the static files</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$DATABASE</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"postgres"</span> <span class="o">]</span>
<span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Waiting for postgres..."</span>

    <span class="k">while</span> <span class="o">!</span> nc <span class="nt">-z</span> <span class="nv">$SQL_HOST</span> <span class="nv">$SQL_PORT</span><span class="p">;</span> <span class="k">do
      </span><span class="nb">sleep </span>0.1
    <span class="k">done

    </span><span class="nb">echo</span> <span class="s2">"PostgreSQL started"</span>

<span class="k">fi

</span>python manage.py flush <span class="nt">--no-input</span>
python manage.py migrate
python manage.py collectstatic <span class="nt">--no-input</span> <span class="nt">--clear</span>

<span class="nb">exec</span> <span class="s2">"</span><span class="se">\$</span><span class="s2">@"</span>
</pre></table></code></div></div><h3 id="how-to-configure-the-production-environment">How to configure the production environment</h3><p>For production, add a volume to the web and nginx services in docker-compose.prod.yml so that each container will share a directory named “staticfiles”:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>version: '3.7'

services:
web:
build:
context: ./app
dockerfile: Dockerfile.prod
command: gunicorn hello_django.wsgi:application --bind 0.0.0.0:8000
volumes: - static_volume:/home/app/web/staticfiles
expose: - 8000
env_file: - ./.env.prod
depends_on: - db
db:
image: postgres:12.0-alpine
volumes: - postgres_data:/var/lib/postgresql/data/
env_file: - ./.env.prod.db
nginx:
build: ./nginx
volumes: - static_volume:/home/app/web/staticfiles
ports: - 1337:80
depends_on: - web

volumes:
postgres_data:
static_volume:
</pre></table></code></div></div><p>We need to also create the “/home/app/web/staticfiles” folder in Dockerfile.prod:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="p">...</span>

<span class="c1"># create the appropriate directories
</span>
<span class="n">ENV</span> <span class="n">HOME</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">app</span>
<span class="n">ENV</span> <span class="n">APP_HOME</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">web</span>
<span class="n">RUN</span> <span class="n">mkdir</span> <span class="err">$</span><span class="n">APP_HOME</span>
<span class="n">RUN</span> <span class="n">mkdir</span> <span class="err">$</span><span class="n">APP_HOME</span><span class="o">/</span><span class="n">staticfiles</span>
<span class="n">WORKDIR</span> \<span class="err">$</span><span class="n">APP_HOME</span>

<span class="p">...</span>
</pre></table></code></div></div><p>Now we have to update our Nginx configuration to route static file requests to the staticfiles folder</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>upstream hello_django {
server web:8000;
}

server {
    listen 80;
    location / {
        proxy_pass http://hello_django;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_redirect off;
    }
    location /staticfiles/ {
        alias /home/app/web/staticfiles/;
    }
}
</pre></table></code></div></div><p>Now lets try our code in the production environment</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>docker-compose down <span class="nt">-v</span>
docker-compose <span class="nt">-f</span> docker-compose.prod.yml up <span class="nt">-d</span> <span class="nt">--build</span>
docker-compose <span class="nt">-f</span> docker-compose.prod.yml <span class="nb">exec </span>web python manage.py migrate <span class="nt">--noinput</span>
docker-compose <span class="nt">-f</span> docker-compose.prod.yml <span class="nb">exec </span>web python manage.py collectstatic <span class="nt">--no-input</span> <span class="nt">--clear</span>
</pre></table></code></div></div><p>Now if you go to <a href="http://localhost:1337/admin">http://localhost:1337/admin</a> you should css the proper Django admin login page with the default django css apply. Well done you have finished the configuration of your Django application.</p><p>You will be able to find the code <a href="https://github.com/dianedelallee/django-in-a-docker">here</a></p><h2 id="references">References</h2><ul><li><strong>Alpine-base Docker image:</strong> <a href="https://github.com/gliderlabs/docker-alpine">Docker-Alpine</a></li><li><strong>Docker Working Directory:</strong> <a href="https://docs.docker.com/engine/reference/builder/#workdir">WORKDIR</a></li><li><strong>Docker for Python Developers:</strong> <a href="https://mherman.org/presentations/dockercon-2018/#1">slides - help you to construct your DockerFiles</a></li><li><strong>Gunicorn:</strong> <a href="https://gunicorn.org/">doc</a></li><li><strong>Nginx:</strong> <a href="https://www.nginx.com/resources/glossary/reverse-proxy-server/">doc</a></li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog/'>Blog</a>, <a href='/categories/python/'>Python</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/docker/" class="post-tag no-text-decoration" >Docker</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/django/" class="post-tag no-text-decoration" >Django</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Launch a Django app in a Docker and be ready to put in Production - Fatalement&url=https://dianedelallee.github.io/posts/django-in-a-docker/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Launch a Django app in a Docker and be ready to put in Production - Fatalement&u=https://dianedelallee.github.io/posts/django-in-a-docker/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Launch a Django app in a Docker and be ready to put in Production - Fatalement&url=https://dianedelallee.github.io/posts/django-in-a-docker/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/end-of-year-review/">2019 - End of year review</a></li><li><a href="/posts/django-import-csv-data/">How to easily import data from CSV file in Django</a></li><li><a href="/posts/coding-club-des-filles/">Coding Club des filles</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/self-review/">self review</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/django/">Django</a> <a class="post-tag" href="/tags/configuration/">Configuration</a> <a class="post-tag" href="/tags/presentation/">presentation</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/poetry/">poetry</a> <a class="post-tag" href="/tags/pipenv/">pipenv</a> <a class="post-tag" href="/tags/json/">json</a> <a class="post-tag" href="/tags/guard/">guard</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/goals-for-the-year/" class="btn btn-outline-primary"><p>My resolutions for 2020</p></a> <a href="/posts/django-with-mongodb/" class="btn btn-outline-primary"><p>Use MongoDB with Django</p></a></div><!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/django-with-mongodb/"><div class="card-body"> <span class="timeago small"> Jan 17, 2020 <i class="unloaded">2020-01-17T13:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Use MongoDB with Django</h3><div class="text-muted small"><p>We will try to use MongoDB with a Django project. To do that we will use the library called Djongo. I have take the previous project (Django-in-a-docker) and I have removed all files relative to th...</p></div></div></a></div><div class="card"> <a href="/posts/django-migration/"><div class="card-body"> <span class="timeago small"> Oct 29, 2018 <i class="unloaded">2018-10-29T07:10:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Django migrations</h3><div class="text-muted small"><p>How create a named empty migration in a specific django app? ./manage.py makemigrations --empty my_django_app_name -n name_of_my_migration How run some python code in my migration? 1 2 3 4 5 6 7...</p></div></div></a></div><div class="card"> <a href="/posts/work-python-env/"><div class="card-body"> <span class="timeago small"> Dec 11, 2018 <i class="unloaded">2018-12-11T13:55:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Work in a proper python environment</h3><div class="text-muted small"><p>When you start a new python project, it is quite important to have a proper environment. With Pipenv, it is quite easy to create a virtual environment, install libraries and manage the version of t...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const observer = lozad(); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://www.linkedin.com/in/dianedelallee">dianedelallee</a >. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span ></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/self-review/">self review</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/django/">Django</a> <a class="post-tag" href="/tags/configuration/">Configuration</a> <a class="post-tag" href="/tags/presentation/">presentation</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/poetry/">poetry</a> <a class="post-tag" href="/tags/pipenv/">pipenv</a> <a class="post-tag" href="/tags/json/">json</a> <a class="post-tag" href="/tags/guard/">guard</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dianedelallee.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
